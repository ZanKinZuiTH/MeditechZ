<UserControl x:Class="MediTech.Views.ListBillPayment"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MediTech.Views.Billing" xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid" xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
             DataContext="{Binding Path=ListBillPaymentViewModel,Source={StaticResource Locator}}"
               xmlns:cv="clr-namespace:MediTech.Converter"
             mc:Ignorable="d" Height="500" Width="980">
    <UserControl.Resources>
        <cv:NumericN2Formatter x:Key="NumericN2Formatter" />
    </UserControl.Resources>
    <AdornerDecorator>
        <dxlc:LayoutControl Orientation="Vertical">
            <dxlc:LayoutItem>
                <Label Name="Title" Content="Bill Payments" FontSize="16" FontWeight="Bold"/>
            </dxlc:LayoutItem>
            <dxlc:LayoutGroup Orientation="Horizontal">
                <dxlc:LayoutItem Label="PaymentMode">
                    <ComboBox  Name="ModeComboBox" ItemsSource="{Binding Path =PaymentModes}" DisplayMemberPath="Display"  SelectedValuePath="Key" SelectedItem = "{Binding Path=SelectedPaymentMode, UpdateSourceTrigger=PropertyChanged}"  SelectedIndex="0"  />
                </dxlc:LayoutItem>
                <dxlc:LayoutGroup Orientation="Horizontal" HorizontalAlignment="Stretch">
                    <dxlc:LayoutItem Label="Amount">
                        <dxe:TextEdit x:Name="txtAmount"  
                                                  EditValue="{Binding Amount,UpdateSourceTrigger=PropertyChanged, Converter={StaticResource NumericN2Formatter}}"
                                                  FontWeight="Bold"
                                                  Mask="n2"
                                                  MaskType="Numeric"/>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem>
                        <ComboBox ItemsSource="{Binding Path =Currencys}" DisplayMemberPath="Display"  SelectedValuePath="Key" SelectedItem= "{Binding Path=SelectedCurrency, UpdateSourceTrigger=PropertyChanged}"  SelectedIndex="0" Width="80" HorizontalAlignment="Left"/>
                    </dxlc:LayoutItem>
                </dxlc:LayoutGroup>

                <dxlc:LayoutItem Label="CollectedOn">
                    <dxe:DateEdit HorizontalAlignment="Left" Name="PaidDatePicker"  EditValue="{Binding Path=PaidDttm, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" MinWidth="155" VerticalAlignment="Center" />

                </dxlc:LayoutItem>

                <dxlc:LayoutItem Label="{Binding Path=ExpiryDateLabel}" Visibility="{Binding Path = ValidityDateVisible,UpdateSourceTrigger=PropertyChanged}">
                    <dxe:DateEdit HorizontalAlignment="Left" Name="StartTimeDatePicker" EditValue="{Binding Path=CardExpiryDttm, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" MinWidth="155" Visibility="{Binding Path = ValidityDateVisible,UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center"/>

                </dxlc:LayoutItem>

            </dxlc:LayoutGroup>
            <dxlc:LayoutGroup Orientation="Horizontal">
                <dxlc:LayoutItem Label="BankName" Visibility="{Binding Path=BankNameVisibility,UpdateSourceTrigger=PropertyChanged}">
                    <ComboBox Name="BankNamecombo"  ItemsSource="{Binding Path =BankNames}"  Visibility="{Binding Path=BankNameVisibility,UpdateSourceTrigger=PropertyChanged}" SelectedValuePath="Key" DisplayMemberPath="Display" SelectedItem="{Binding Path=SelectedBank,UpdateSourceTrigger=PropertyChanged}" />
                </dxlc:LayoutItem>

                <dxlc:LayoutGroup Orientation="Vertical">
                    <dxlc:LayoutItem Label="Number" Visibility="{Binding Path =IsEnableCardNumber}">
                        <dxe:TextEdit  Name="CardNumberTextBox" Text="{Binding Path=CardNumber}" ></dxe:TextEdit>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Label="CardType" Visibility="{Binding Path = IsEnableCardType,UpdateSourceTrigger=PropertyChanged}">
                        <ComboBox Name="CardTypeComboBox" ItemsSource="{Binding Path = CardTypes}" DisplayMemberPath="Display"  SelectedValuePath="Key" SelectedItem= "{Binding Path=SelectedCardType, UpdateSourceTrigger=PropertyChanged}"  Visibility="{Binding Path = IsEnableCardType}" />
                    </dxlc:LayoutItem>
                </dxlc:LayoutGroup>



                <dxlc:LayoutItem Label="Auth Rept No."  Visibility="{Binding Path = IsEnableCardType,UpdateSourceTrigger=PropertyChanged}">
                    <dxe:TextEdit   Name="AuthRecptNoTxt" Text="{Binding Path=AuthorizationNumber,UpdateSourceTrigger=PropertyChanged}"   ></dxe:TextEdit>
                </dxlc:LayoutItem>
                <dxlc:LayoutItem Label="CardNo"  Visibility="{Binding Path = IsEnableCardType,UpdateSourceTrigger=PropertyChanged}">
                    <dxe:TextEdit Name="CardNumberTextBox2" Text="{Binding Path=CardNumber,UpdateSourceTrigger=PropertyChanged}" ></dxe:TextEdit>
                </dxlc:LayoutItem>
            </dxlc:LayoutGroup>

            <dxlc:LayoutGroup  HorizontalAlignment="Right" Name="dockpanel2" >
                <Button  VerticalAlignment="Bottom" Width="80"  Content="Add"  Name="AddPaymentItemButton" Command="{Binding AddPaymentItemCommand}" ></Button>
                <Button  VerticalAlignment="Bottom" Width="80"  Content="Update"  Name="UpdatePaymentItemButton" Command="{Binding UpdatePaymentItemCommand}"></Button>
                <Button  VerticalAlignment="Bottom" Width="80" Content="Delete" Name="DeletePaymentItemButton" Command="{Binding DeletePaymentItemCommand}"></Button>
            </dxlc:LayoutGroup>
            <dxg:GridControl Name="grdPaymentDetails" ItemsSource="{Binding PaymentDetailsList}"
                         SelectedItem="{Binding SelectedPaymentDetail}" 
                         >
                <dxg:GridColumn FieldName="PaidDttm" Header="Paid Date" ReadOnly="True"/>
                <dxg:GridColumn FieldName="Amount" Header="Amount" ReadOnly="True"/>
                <dxg:GridColumn FieldName="Currency" Header="Currency" ReadOnly="True"/>
                <dxg:GridColumn FieldName="PaymentMode" Header="Payment Mode" ReadOnly="True"/>
                <dxg:GridColumn FieldName="BankName" Header="BankName" ReadOnly="True"/>
                <dxg:GridColumn FieldName="CardType" Header="Card Type" ReadOnly="True"/>
                <dxg:GridColumn FieldName="CardNumber" Header="Card Number" ReadOnly="True"/>
                <dxg:GridControl.View>
                    <dxg:TableView ShowGroupPanel="False"/>
                </dxg:GridControl.View>
            </dxg:GridControl>

            <dxlc:LayoutGroup HorizontalAlignment="Stretch">

                <!--Total Amount-->
                <dxlc:LayoutItem Label="Total Amount" HorizontalAlignment="Left">
                    <dxe:TextEdit x:Name="txtTotalAmount"  
                                                  EditValue="{Binding TotalAmount,UpdateSourceTrigger=PropertyChanged}"
                                                  FontWeight="Bold" Width="100"
                                                  DisplayFormatString="#,#0.00"
                                                  IsEnabled="False" MaskType="Numeric"/>
                </dxlc:LayoutItem>
                <dxlc:LayoutItem Label="Amount Received" HorizontalAlignment="Left" Margin="20,0,0,0">
                    <dxe:TextEdit x:Name="txtAmountReceived"  
                                                  EditValue="{Binding AmountReceived,UpdateSourceTrigger=PropertyChanged}"
                                                  FontWeight="Bold" Width="100"
                                                  DisplayFormatString="#,#0.00"
                                                  IsEnabled="False" MaskType="Numeric"/>
                </dxlc:LayoutItem>
                <dxlc:LayoutItem Label="Net Payable" HorizontalAlignment="Right">
                    <dxe:TextEdit x:Name="txtNetPayable"  
                                                  EditValue="{Binding NetPayable,UpdateSourceTrigger=PropertyChanged}"
                                                  FontWeight="Bold" Width="100"
                                                  DisplayFormatString="#,#0.00"
                                                  IsEnabled="False" MaskType="Numeric"/>
                </dxlc:LayoutItem>


            </dxlc:LayoutGroup>

            <dxlc:LayoutGroup  HorizontalAlignment="Right">
                <Button Name="SaveButton" Content="บันทึก" Command="{Binding SaveCommand}" Width="80" Height="25" VerticalAlignment="Bottom" HorizontalAlignment="Right"/>
                <Button Name="CloseButton" Content="ยกเลิก" Command="{Binding CancelCommand}" Width="80" Height="25" VerticalAlignment="Bottom" HorizontalAlignment="Right"/>
            </dxlc:LayoutGroup>

        </dxlc:LayoutControl>
    </AdornerDecorator>
</UserControl>
